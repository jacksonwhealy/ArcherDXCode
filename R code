# Install data management, epi, and analysis packages
install.packages("tidyverse") 
install.packages("splitstackshape")
install.packages("epiR") 
install.packages("lmtest") 
install.packages("Epi") 
install.packages("popEpi")
install.packages("survival") 
install.packages("survminer")
install.packages("lme4")
install.packages("sjstats")
install.packages("mice")
install.packages("arsenal")
install.packages("survey")
install.packages("ICC")
install.packages("meta")
install.packages("metafor")
install.packages("broom.mixed")

# Load packages
library(tidyverse)
library(lmtest)
library(survival)
library(survminer)
library(epiR)
library(Epi)
library(lme4)
library(popEpi)
library(mice)
library(sjstats)
library(splitstackshape)
library(arsenal)
library(survey)
library(ICC)
library(meta)
library(metafor)
library(broom)
library(broom.mixed)

# Set working directory, load data set, explore data
setwd("~/Desktop/R")

archerdx <- read.csv(file = "coding_example_dat.csv", header = TRUE, sep = ",")

view(archerdx)

# 1. Create	a	plot	or	plots	that	visually	assess	whether	there	is	a	difference	the	measurements	taken	with	device	A	and	device	B.

#create new variables for values of device A
archerdx$valueA <-ifelse(archerdx$device=="dev_A",
                        c(archerdx$value), c(NA))
as.numeric(archerdx$valueA)

archerdx$fingersA <-ifelse(archerdx$measurement=="finger_lengths",
                         c(archerdx$valueA), c(NA))
as.numeric(archerdx$fingersA)

archerdx$toesA <-ifelse(archerdx$measurement=="toe_lengths",
                           c(archerdx$valueA), c(NA))
as.numeric(archerdx$toeA)

#create new variable for values of device B
archerdx$valueB <-ifelse(archerdx$device=="dev_B",
                         c(archerdx$value), c(NA))
as.numeric(archerdx$valueB)

archerdx$fingersB <-ifelse(archerdx$measurement=="finger_lengths",
                           c(archerdx$valueB), c(NA))
as.numeric(archerdx$fingersB)

archerdx$toesB <-ifelse(archerdx$measurement=="toe_lengths",
                        c(archerdx$valueB), c(NA))
as.numeric(archerdx$toeB)

#create histograms

hist(archerdx$valueA, main="Device A Measurements, Fingers and Toes", xlab = "Measurement (mm)", col="blue")
hist(archerdx$valueB, main="Device B Measurements, Figers and Toes", xlab = "Measurement (mm)", col="red")

hist(archerdx$fingersA, main="Device A Measurements, Fingers", xlab = "Measurement (mm)", col="blue")
hist(archerdx$fingersB, main="Device B Measurements, Fingers", xlab = "Measurement (mm)", col="red")

hist(archerdx$toesA, main="Device A Measurements, Toes", xlab = "Measurement (mm)", col="blue")
hist(archerdx$toesB, main="Device B Measurements, Toes", xlab = "Measurement (mm)", col="red")

# create box-and-whisker plots

boxplot(archerdx$valueA, archerdx$valueB,
        names=c("Device A","Device B"),
        ylab="Measurement (mm)")

boxplot(archerdx$fingersA, archerdx$fingersB,
        names=c("Device A","Device B"),
        ylab="Measurement (mm)")

boxplot(archerdx$toesA, archerdx$toesB,
        names=c("Device A","Device B"),
        ylab="Measurement (mm)")
        

# 2. Create	a	table	with	descriptive	statistics	for	the	two	devices	(mean,	median,	and	standard	deviation)

# mean
mean(archerdx$value)
mean(archerdx$valueA, na.rm=TRUE)
mean(archerdx$valueB, na.rm=TRUE)

#median
median(archerdx$value)
median(archerdx$valueA, na.rm=TRUE)
median(archerdx$valueB, na.rm=TRUE)

#standard error
sd(archerdx$value)
sd(archerdx$valueA, na.rm=TRUE)
sd(archerdx$valueB, na.rm=TRUE)



# 3. Were	the	measurements	collected	with	device	A	significantly	different	than	those	collected	with	device	B?

# perform a t-test comparing the mean values measured by device A to the mean values of measured by device B

# Test 1: Combined Values
t.test(archerdx$valueA,archerdx$valueB)
# Conclusion: there is no significant difference in the measurements between device A and device B

# Test 2: Fingers Only
t.test(archerdx$fingersA,archerdx$fingersB)
# Conclusion: there is no significant difference in the measurements between device A and device B

# Test 3: Toes Only 
t.test(archerdx$toesA,archerdx$toesB)
# Conclusion: there is no significant difference in the measurements between device A and device B

# 4. Convert	the	measurement	values	to	a	binary	outcome	using	the	following	rules: 
#    a. For	finger_length:	values	<	80	=	'short', values	≥	80	=	'long'
#    b. For	finger_length:	values	<	25	=	'short',	values	≥	25	=	'long'
#    c. Calculate	the	overall	percent	agreement	in binary results	between	the	two	devices.



